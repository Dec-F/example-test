<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="./bundle4.js"></script>
    <!-- <script src="http://g.tbcdn.cn/mtb/lib-flexible/0.3.4/??flexible_css.js,flexible.js"></script> -->
    <title>Document</title>
</head>

<body>
    <div>asdasd</div>
    <script>

        function setPbValues (valObject,recObject) {
            var keys = Object.keys(valObject)
            keys.forEach(function(val) {
                var s=val
                s=`${s[0].toUpperCase()}${s.slice(1)}`
                recObject['set'+s](valObject[val])
            })
        }
        
        var p =new pbModel.LoginResp();
        console.log(pbModel);
        setPbValues({
            status:0
        },p)
        // p.setUid(111);
        // p.setGender(1);
        // p.addGuardarray(222,2)
        // p.setEmail('xx@xx.com');
        var binary = p.serializeBinary();
        console.log('序列化:',p);
        console.log('二进制:',binary);
        var person =  pbModel.LoginResp.deserializeBinary(binary);

        console.log('解码后:',person);
        console.log('解析序列:',person.toObject());



    //     var pbModel = (function() {
    //         var serviceName2Class = $.extend({}, serviceName2ClassList);
    //         var pb= PbModule
    
    //         function setPbValues (valObject,recObject) {
    //             var keys = Object.keys(valObject)
    //             keys.forEach(function(val) {
    //                 var s=val
    //                 s='set'+s[0].toUpperCase()+s.slice(1).toLowerCase()
                    
    //                 recObject[s](valObject[val])
    //             })
    //         }
    //         // protobuf.load(staticPath + 'js/linkerProtocol.proto', function(err, root) {
    //         //     if (err) {
    //         //         throw err;
    //         //     }
    
    //         //     protobufRoot = root;
    //         //     // console.log('root',root);
    
    //         //     $.pub('protobufLoadEnd', []);
    //         // });
    
            
    
    //         // function encodeProtobufMessage(serviceName, objData) {
    //         //     var MessageModel = protobufRoot.lookup('linkerProtocol.' + serviceName2Class[serviceName]);
    //         //     var message = MessageModel.create(objData);
    //         //     var errMsg = MessageModel.verify(message);
    //         //     if (errMsg) {
    //         //         throw Error(errMsg);
    //         //         console.log('[encodeProtobufMessage]', serviceName, objData);
    //         //         return;
    //         //     }
    //         //     var buffer = MessageModel.encode(message).finish();
    //         //     return buffer;
    //         // };
    //         function encodeProtobufMessage(serviceName, objData) {
    //             var ser=serviceName2Class[serviceName]
    //             var messageModel =new pb[ser]()
    //             console.log(messageModel);
    
    //             // messageModel.setAttrid(1)
    //             // console.log(messageModel);
    //             setPbValues(objData,messageModel)
    
    //             var buffer = messageModel.serializeBinary()
    
    //             return buffer
    //         };
    
    //         // function decodeProtobufMessage(serviceName, buffer) {
    //         //     var MessageModel = protobufRoot.lookup('linkerProtocol.' + serviceName2Class[serviceName]);
    //         //     var message = MessageModel.decode(buffer, buffer.byteLength);
    //         //     var errMsg = MessageModel.verify(message);
    //         //     if (errMsg) {
    //         //         throw Error(errMsg);
    //         //         console.log('[decodeProtobufMessage]', serviceName, buffer);
    //         //         return;
    //         //     }
    //         //     return message;
    //         // };
    //         function decodeProtobufMessage(serviceName, buffer) {
    //             var ser=serviceName2Class[serviceName]
    //             var message =new pb[ser](buffer)
    // debugger
    //            message = message.toObject()
    
    //            return message
    //         };
    
    //         return {
    //             encodeProtobufMessage: encodeProtobufMessage,
    //             decodeProtobufMessage: decodeProtobufMessage
    //         };
    //     })();


     var  old= '{"0":8,"1":172,"2":142,"3":230,"4":237,"5":6,"6":18,"7":14,"8":107,"9":122,"10":99,"11":50,"12":83,"13":89,"14":50,"15":56,"16":102,"17":50,"18":54,"19":100,"20":101,"21":99,"22":26,"23":0,"24":34,"25":6,"26":119,"27":101,"28":98,"29":97,"30":112,"31":112,"32":40,"33":209,"34":215,"35":234,"36":204,"37":5,"38":50,"39":48,"40":52,"41":102,"42":103,"43":86,"44":83,"45":68,"46":106,"47":54,"48":43,"49":43,"50":114,"51":67,"52":108,"53":83,"54":89,"55":75,"56":107,"57":56,"58":53,"59":90,"60":102,"61":82,"62":77,"63":50,"64":81,"65":99,"66":117,"67":48,"68":90,"69":82,"70":119,"71":100,"72":118,"73":84,"74":97,"75":90,"76":98,"77":82,"78":84,"79":97,"80":84,"81":108,"82":116,"83":113,"84":109,"85":81,"86":61,"87":61,"88":58,"89":11,"90":50,"91":48,"92":49,"93":55,"94":48,"95":51,"96":50,"97":49,"98":46,"99":48,"100":49,"101":66,"102":6,"103":119,"104":101,"105":105,"106":120,"107":105,"108":110}'
        var pb='{"0":8,"1":172,"2":142,"3":230,"4":237,"5":6,"6":18,"7":14,"8":107,"9":122,"10":99,"11":50,"12":83,"13":89,"14":50,"15":56,"16":102,"17":50,"18":54,"19":100,"20":101,"21":99,"22":26,"23":0,"24":34,"25":6,"26":119,"27":101,"28":98,"29":97,"30":112,"31":112,"32":40,"33":209,"34":215,"35":234,"36":204,"37":5,"38":50,"39":48,"40":52,"41":102,"42":103,"43":86,"44":83,"45":68,"46":106,"47":54,"48":43,"49":43,"50":114,"51":67,"52":108,"53":83,"54":89,"55":75,"56":107,"57":56,"58":53,"59":90,"60":102,"61":82,"62":77,"63":50,"64":81,"65":99,"66":117,"67":48,"68":90,"69":82,"70":119,"71":100,"72":118,"73":84,"74":97,"75":90,"76":98,"77":82,"78":84,"79":97,"80":84,"81":108,"82":116,"83":113,"84":109,"85":81,"86":61,"87":61,"88":58,"89":11,"90":50,"91":48,"92":49,"93":55,"94":48,"95":51,"96":50,"97":49,"98":46,"99":48,"100":49,"101":66,"102":6,"103":119,"104":101,"105":105,"106":120,"107":105,"108":110}'

       console.log( pb===old)
    </script>
</body>

</html>